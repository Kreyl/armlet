<!DOCTYPE HTML>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="Author" content="Vasily Zakharov <vmzakhar@gmail.com>">
<title>Armlet GUI Test</title>
<style type="Text/CSS">
html, body {
  margin: 0;
  padding: 0;
}

#case {
  width: 160px;
  height: 128px;
  padding: 13px 89px 47px 89px;
  background: url('ArmletDemo.png');
  margin: 5em;
}

#gui {
  width: 160px;
  height: 128px;
  position: relative;
  margin: 0;
  padding: 0;
}

.screen {
  width: 100%;
  height: 100%;
  background-color: #ffeeaf;
  margin: 0;
  padding: 0;
  display: none;
}

.screen pre {
  margin: 0;
  padding: 0;
  position: absolute;
  top: -3px;
  font-family: B52, "DS Moster", "Courier New", monospace;
  font-size: 14px;
  color: #3c463c;
}

.button {
  position: absolute;
}

#lock {
  position: absolute;
  display: none;
}

#mark {
  position: absolute;
}
</style>
<script type="Text/JavaScript">
var IMAGES = '../SD/GUI/';

var A = 'A';
var B = 'B';
var C = 'C';
var L = 'L';
var E = 'E';
var R = 'R';
var X = 'X';
var Y = 'Y';
var Z = 'Z';

var ABSENT = 0;
var NORMAL = 1;
var PRESSED = 2;
var NOT = 3;
var ENABLED = 4;
var DISABLED = 5;

var STATES = ['absent', 'normal', 'pressed', 'not', 'enabled', 'disabled'];

var TITLE = 'FLastname   23:59';

var currentScreen = null;

var locked = false;

function setState(button, state) {
    button.state = state;
    button.src = button.states[state];
}

function mouseDown() {
    var newState = null;
    switch (this.key) {
    case B:
    case C:
    case E:
    case X:
    case Y:
    case Z:
        if (locked) {
            break;
        }
    case L:
        newState = PRESSED;
        break;
    }
    if (newState != null) {
        setState(this, newState);
    }
}

function mouseUp() {
    if (this.state == NOT) {
        setState(this, NORMAL);
    }
    if (this.state != PRESSED) {
        return;
    }
    var newScreen = currentScreen;
    switch (this.key) {
    case L:
        newScreen = 0;
        locked = !locked;
        break;
    case E:
        newScreen = (currentScreen + 1) % screens.length;
        mark.style.display = currentScreen ? 'block' : 'none';
        break;
    case B:
    case C:
    case X:
    case Y:
    case Z:
        if (currentScreen != 0) {
            this.enabled = !this.enabled;
            setState(this, this.enabled ? ENABLED : NORMAL);
        }
        break;
    }
    var buttons = screens[newScreen].buttons;
    for (var i = 0, button; button = buttons[i++];) {
        if (button.state == PRESSED || button.state == NOT) {
            setState(button, NORMAL);
        }
    }
    if (newScreen != currentScreen) {
        screens[currentScreen].style.display = 'none';
        currentScreen = newScreen;
        screens[currentScreen].style.display = 'block';
    }
    lock.style.display = locked ? 'block' : 'none';
}

function mouseOut() {
    if (this.state == PRESSED || this.state == NOT) {
        setState(this, NORMAL);
    }
}

function main() {
    screens = document.getElementsByClassName('screen');
    for (var i = 0, screen; screen = screens[i++];) {
        var pre = document.createElement('pre');
        pre.appendChild(document.createTextNode(TITLE));
        screen.insertBefore(pre, screen.firstChild);
        screen.style.backgroundImage = 'url(' + IMAGES + screen.id + '/back.bmp)';
        if (i == 1) {
            screen.style.display = 'block';
            currentScreen = i - 1;
        }
        screen.buttons = screen.getElementsByClassName('button');
        for (var j = 0, button; button = screen.buttons[j++];) {
            button.key = button.getAttribute('key');
            button.enabled = false;
            var prefix = IMAGES + screen.id + '/';
            var suffix = '/' + button.key + '.bmp';
            button.states = [];
            for (var k = 0; k < STATES.length; k++) {
              button.states[k] = prefix + STATES[k] + suffix;
            }
            button.onmousedown = mouseDown;
            button.onmouseup = mouseUp;
            button.onmouseout = mouseOut;
            setState(button, NORMAL);
        }
    }
    lock = document.getElementById('lock');
    lock.src = IMAGES + 'lock.bmp';
    mark = document.getElementById('mark');
    mark.src = IMAGES + 'main/mark.bmp';
}
</script>
</head>
<body onload="main()">
  <div id="case">
    <div id="gui">
      <div id="main" class="screen">
        <img class="button" key="B" tag="fight" alt="Драка" style="top: 45px">
        <img class="button" key="C" tag="sex" alt="Секс" style="top: 82px">
        <img class="button" key="X" alt="M" style="left: 130px; top: 19px">
        <img class="button" key="Y" alt="^^" style="left: 127px; top: 60px">
        <img class="button" key="Z" alt="vv" style="left: 127px; top: 95px">
        <img class="button" key="L" alt="lock" style="left: 4px; top: 110px">
        <img class="button" key="E" alt="экран" style="left: 59px; top: 111px">
      </div>
      <div id="intentions" class="screen">
        <img class="button" key="B" tag="murder" alt="Убийство" style="top: 42px">
        <img class="button" key="C" tag="destr" alt="Разрушение" style="top: 82px">
        <img class="button" key="X" tag="creation" alt="Созидание" style="left: 82px; top: 26px">
        <img class="button" key="Z" tag="death" alt="Смерть" style="left: 105px; top: 99px">
        <img class="button" key="L" alt="lock" style="left: 4px; top: 110px">
        <img class="button" key="E" alt="экран" style="left: 59px; top: 111px">
      </div>
      <img id="lock" style="left: 62px; top: 44px">
      <img id="mark" style="left: 157px; top: 113px">
    </div>
  </div>
</body>
</html>
